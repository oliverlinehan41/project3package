---
title: "Project 3: project3package Turorial"
author: "Oliver Linehan"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{project3package Turorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This is a compilation of various topics I have learned in Stat 302. It includes functions regarding hypothesis testing, linear modeling, and statistical prediction. You can use the following code to install project3package:
```{r, eval=FALSE}
devtools::install_github("oliverlinehan41/project3package")
```

```{r setup}
library(project3package)
```

One function in this package is the my_t_test function. This is a function that allows the user to perform a t_test on a set of data. First, I will demonstrate a two-sided t-test on the gapminder data regarding life-expectancy. 

```{r}
library(gapminder)
my_t_test(gapminder$lifeExp, "two.sided", 60)
```
The p-value from this test is ~ 0.09. This means that if we assume that the average life expectancy is 60 years, we could expect around 9% of samples of the same size to have a more extreme average life expectency value than we obtained, in either direction. With an alpha cutoff of 0.05, this is not significant enough to reject the null hypothesis that the average life expectancy is 60 years.

Next, I will do a one sided t-test on the same data, where the alternative hypothesis is that the average life expectancy is less than 60 years.

```{r}
my_t_test(gapminder$lifeExp, "less", 60)
```
The p-value from this test is ~ 0.047. This means that if we assume that the average life expectancy is 60 years, we would expect that around 4.7% of samples of the same size would have a lower average life expectancy value than we obtained. With an alpha cutoff of 0.05, this is significant enough to reject the null hypothesis that the average life expectancy is 60 years, as it is likely lower.

Finally, I will do a one-sided t-test on the same data, where the alternative hypothesis is that the average life expectancy is greater than 60 years.

```{r}
my_t_test(gapminder$lifeExp, "greater", 60)
```
The p-value from this test is ~0.95. This means that if we assume that the average life expectancy is 60 years, we would expect that around 95% of samples of the same size would have a higher average life expectancy value than we obtained. With an alpha cutoff of 0.05, this is not sufficient evidence to reject the null hypothesis that the average life expectancy is 60 years.



Another function in project3package is the my_lm function. This function allows you to build a linear model for a set of data. For example, the following code builds a linear model of how GDP per capita and continent correlate with life expectency in the gapminder data.

```{r}
my_lm(lifeExp ~ gdpPercap + continent, gapminder)


```
The "estimate" value is the linear coefficient for each variable. For gdpPercap, for example, the coefficient is 4.45 * 10^-4. This means that all else being equal, a $10,000 increase in GDP per capita would mean that our predicted life expectency would increase by 4.45 years. For a hypothesis test, our null hypothesis would be that GDP per capita and life expectency do not have a relationship, which means that our linear coefficient for gdpPercap would be 0. Our alternative hypothesis is that gdpPercap and life expectency do have a relationship. The p-value for the linear coefficient for gdpPercap is 8.55*10^-73, which is very small. This means that if our true coefficient is 0, only an astronomically tiny proportion of samples would have a more extreme coefficient, in either direction. With a cutoff of 0.05, we can conclude that there is evidence to support a relationship between GDP per capita and life expectancy. 

To examine the effectiveness of the model, we can plot the estimated/fitted values for life expectancy with the actual values from the gapminder data.

```{r}
library(ggplot2)
fit_mod <- fitted(lm(lifeExp ~ gdpPercap + continent, gapminder))
lm_df <- data.frame(actual = gapminder$lifeExp, fitted = fit_mod)
ggplot(lm_df, aes(x = fitted, y = actual)) +
  geom_point()+
  geom_abline(slope = 1, intercept = 0, col = "blue", lty = 2) +
  theme_bw() +
  labs(x = "Fitted Values", y = "Actual Values", title = "Actual vs. Fitted") +
  theme(plot.title = element_text(hjust = 0.5))


```
As demonstrated by the deviation of a linear pattern between fitted and actual values, this model is not a good fit for the data. When the predicted life expectancy is greater than 70 and less than 85, the model does pretty well, but when it's less than 70, or greater than 85, the model pretty much completely loses any accuracy.
